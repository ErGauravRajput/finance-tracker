import{u as C,r as s,j as e}from"./index-Rc-Xpk4O.js";import{a as h}from"./axios-CIYRMzzG.js";const p={type:"expense",category:"",amount:"",date:""},T=()=>{const{user:d}=C(),[u,j]=s.useState([]),[r,m]=s.useState(p),[l,y]=s.useState(""),[o,g]=s.useState("all"),n=(d==null?void 0:d.role)==="read-only",c=s.useCallback(async()=>{try{const{data:t}=await h.get("/transactions");j(t)}catch(t){console.error(t)}},[]);s.useEffect(()=>{c()},[c]);const i=t=>m(a=>({...a,[t.target.name]:t.target.value})),b=async t=>{if(t.preventDefault(),!n)try{await h.post("/transactions",{...r,amount:Number(r.amount)}),m(p),c()}catch(a){console.error(a)}},v=async t=>{if(!n)try{await h.delete(`/transactions/${t}`),c()}catch(a){console.error(a)}},x=s.useMemo(()=>u.filter(t=>{const a=t.category.toLowerCase().includes(l.toLowerCase())||String(t.amount).includes(l),f=o==="all"||t.type===o;return a&&f}),[u,l,o]);return e.jsxs("div",{className:"page",children:[e.jsx("h2",{children:"Transactions"}),e.jsxs("form",{className:"form-inline",onSubmit:b,children:[e.jsxs("select",{name:"type",value:r.type,onChange:i,disabled:n,children:[e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]}),e.jsx("input",{name:"category",placeholder:"Category",value:r.category,onChange:i,required:!0,disabled:n}),e.jsx("input",{name:"amount",type:"number",placeholder:"Amount",value:r.amount,onChange:i,required:!0,disabled:n}),e.jsx("input",{name:"date",type:"date",value:r.date,onChange:i,required:!0,disabled:n}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Read-only":"Add"})]}),e.jsxs("div",{className:"filters",children:[e.jsx("input",{placeholder:"Search by category/amount",value:l,onChange:t=>y(t.target.value)}),e.jsxs("select",{value:o,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Amount (₹)"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Action"})]})}),e.jsxs("tbody",{children:[x.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.type}),e.jsx("td",{children:t.category}),e.jsx("td",{children:t.amount}),e.jsx("td",{children:t.date}),e.jsx("td",{children:e.jsx("button",{className:"btn-danger",onClick:()=>v(t.id),disabled:n,children:"Delete"})})]},t.id)),!x.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{textAlign:"center"},children:"No transactions"})})]})]}),n&&e.jsxs("p",{className:"hint",children:["You are ",e.jsx("b",{children:"read-only"}),", so you can’t add/delete transactions."]})]})};export{T as default};
